function u = interpolation(t,uIn,t0,k)

    if k == 0

        u = uIn;

    elseif k == 1

        u = uIn(1) + (t-t0(1)) * (uIn(2)-uIn(1))/(t0(2)-t0(1));

    elseif k == 2

        const = [(-t0(2)*uIn(1)+t0(3)*uIn(1)-t0(1)*uIn(3)+t0(2)*uIn(3)+t0(1)*uIn(2)-t0(3)*uIn(2))/(t0(1)*t0(2)^2-t0(1)^2*t0(2)-t0(1)*t0(3)^2+t0(2)*t0(3)^2+t0(1)^2*t0(3)-t0(2)^2*t0(3)),...
            (t0(2)^2*uIn(1)-t0(3)^2*uIn(1)+t0(1)^2*uIn(3)-t0(2)^2*uIn(3)-t0(1)^2*uIn(2)+t0(3)^2*uIn(2))/(t0(1)*t0(2)^2-t0(1)^2*t0(2)-t0(1)*t0(3)^2+t0(2)*t0(3)^2+t0(1)^2*t0(3)-t0(2)^2*t0(3)),...
            (t0(2)*t0(3)^2*uIn(1)-t0(2)^2*t0(3)*uIn(1)+t0(1)*t0(2)^2*uIn(3)-t0(1)^2*t0(2)*uIn(3)-t0(1)*t0(3)^2*uIn(2)+t0(1)^2*t0(3)*uIn(2))/(t0(1)*t0(2)^2-t0(1)^2*t0(2)-t0(1)*t0(3)^2+t0(2)*t0(3)^2+t0(1)^2*t0(3)-t0(2)^2*t0(3))...
            ];

        u = const(1) * t^2 + const(2) * t + const(3);


    elseif k == 3

        const = [- uIn(1)/(t0(1)^(2)*t0(2) + t0(1)^(2)*t0(3) + t0(1)^(2)*t0(4) - t0(1)^(3) - t0(1)*t0(2)*t0(3) - t0(1)*t0(2)*t0(4) - t0(1)*t0(3)*t0(4) + t0(2)*t0(3)*t0(4)) - uIn(2)/(t0(1)*t0(2)^(2) + t0(2)^(2)*t0(3) + t0(2)^(2)*t0(4) - t0(2)^(3) - t0(1)*t0(2)*t0(3) - t0(1)*t0(2)*t0(4) + t0(1)*t0(3)*t0(4) - t0(2)*t0(3)*t0(4)) - uIn(3)/(t0(1)*t0(3)^(2) + t0(2)*t0(3)^(2) + t0(3)^(2)*t0(4) - t0(3)^(3) - t0(1)*t0(2)*t0(3) + t0(1)*t0(2)*t0(4) - t0(1)*t0(3)*t0(4) - t0(2)*t0(3)*t0(4)) - uIn(4)/(t0(1)*t0(4)^(2) + t0(2)*t0(4)^(2) + t0(3)*t0(4)^(2) - t0(4)^(3) + t0(1)*t0(2)*t0(3) - t0(1)*t0(2)*t0(4) - t0(1)*t0(3)*t0(4) - t0(2)*t0(3)*t0(4)),...
                (uIn(1)*(t0(2) + t0(3) + t0(4)))/(t0(1)^(2)*t0(2) + t0(1)^(2)*t0(3) + t0(1)^(2)*t0(4) - t0(1)^(3) - t0(1)*t0(2)*t0(3) - t0(1)*t0(2)*t0(4) - t0(1)*t0(3)*t0(4) + t0(2)*t0(3)*t0(4)) + (uIn(2)*(t0(1) + t0(3) + t0(4)))/(t0(1)*t0(2)^(2) + t0(2)^(2)*t0(3) + t0(2)^(2)*t0(4) - t0(2)^(3) - t0(1)*t0(2)*t0(3) - t0(1)*t0(2)*t0(4) + t0(1)*t0(3)*t0(4) - t0(2)*t0(3)*t0(4)) + (uIn(3)*(t0(1) + t0(2) + t0(4)))/(t0(1)*t0(3)^(2) + t0(2)*t0(3)^(2) + t0(3)^(2)*t0(4) - t0(3)^(3) - t0(1)*t0(2)*t0(3) + t0(1)*t0(2)*t0(4) - t0(1)*t0(3)*t0(4) - t0(2)*t0(3)*t0(4)) + (uIn(4)*(t0(1) + t0(2) + t0(3)))/(t0(1)*t0(4)^(2) + t0(2)*t0(4)^(2) + t0(3)*t0(4)^(2) - t0(4)^(3) + t0(1)*t0(2)*t0(3) - t0(1)*t0(2)*t0(4) - t0(1)*t0(3)*t0(4) - t0(2)*t0(3)*t0(4)),...
                - (uIn(1)*(t0(2)*t0(3) + t0(2)*t0(4) + t0(3)*t0(4)))/(t0(1)^(2)*t0(2) + t0(1)^(2)*t0(3) + t0(1)^(2)*t0(4) - t0(1)^(3) - t0(1)*t0(2)*t0(3) - t0(1)*t0(2)*t0(4) - t0(1)*t0(3)*t0(4) + t0(2)*t0(3)*t0(4)) - (uIn(2)*(t0(1)*t0(3) + t0(1)*t0(4) + t0(3)*t0(4)))/(t0(1)*t0(2)^(2) + t0(2)^(2)*t0(3) + t0(2)^(2)*t0(4) - t0(2)^(3) - t0(1)*t0(2)*t0(3) - t0(1)*t0(2)*t0(4) + t0(1)*t0(3)*t0(4) - t0(2)*t0(3)*t0(4)) - (uIn(3)*(t0(1)*t0(2) + t0(1)*t0(4) + t0(2)*t0(4)))/(t0(1)*t0(3)^(2) + t0(2)*t0(3)^(2) + t0(3)^(2)*t0(4) - t0(3)^(3) - t0(1)*t0(2)*t0(3) + t0(1)*t0(2)*t0(4) - t0(1)*t0(3)*t0(4) - t0(2)*t0(3)*t0(4)) - (uIn(4)*(t0(1)*t0(2) + t0(1)*t0(3) + t0(2)*t0(3)))/(t0(1)*t0(4)^(2) + t0(2)*t0(4)^(2) + t0(3)*t0(4)^(2) - t0(4)^(3) + t0(1)*t0(2)*t0(3) - t0(1)*t0(2)*t0(4) - t0(1)*t0(3)*t0(4) - t0(2)*t0(3)*t0(4)),...
                (t0(2)*t0(3)*t0(4)*uIn(1))/(t0(1)^(2)*t0(2) + t0(1)^(2)*t0(3) + t0(1)^(2)*t0(4) - t0(1)^(3) - t0(1)*t0(2)*t0(3) - t0(1)*t0(2)*t0(4) - t0(1)*t0(3)*t0(4) + t0(2)*t0(3)*t0(4)) + (t0(1)*t0(3)*t0(4)*uIn(2))/(t0(1)*t0(2)^(2) + t0(2)^(2)*t0(3) + t0(2)^(2)*t0(4) - t0(2)^(3) - t0(1)*t0(2)*t0(3) - t0(1)*t0(2)*t0(4) + t0(1)*t0(3)*t0(4) - t0(2)*t0(3)*t0(4)) + (t0(1)*t0(2)*t0(4)*uIn(3))/(t0(1)*t0(3)^(2) + t0(2)*t0(3)^(2) + t0(3)^(2)*t0(4) - t0(3)^(3) - t0(1)*t0(2)*t0(3) + t0(1)*t0(2)*t0(4) - t0(1)*t0(3)*t0(4) - t0(2)*t0(3)*t0(4)) + (t0(1)*t0(2)*t0(3)*uIn(4))/(t0(1)*t0(4)^(2) + t0(2)*t0(4)^(2) + t0(3)*t0(4)^(2) - t0(4)^(3) + t0(1)*t0(2)*t0(3) - t0(1)*t0(2)*t0(4) - t0(1)*t0(3)*t0(4) - t0(2)*t0(3)*t0(4))];

        u = const(1) * t^3 + const(2) * t^2 + const(3) * t + const(4);

    else

        const = polyfit(t0,uIn,k);
        u = polyval(const,t);

    end

end